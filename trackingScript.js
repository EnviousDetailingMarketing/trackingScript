function uuidv4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=16*Math.random()|0;return("x"==e?n:3&n|8).toString(16)})}function getCookie(e){for(var n=e+"=",t=document.cookie.split(";"),r=0;r<t.length;r++){for(var a=t[r];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(n))return a.substring(n.length,a.length)}return null}function setCookie(e,n,t){var r="";if(t){var a=new Date;a.setTime(a.getTime()+864e5*t),r="; expires="+a.toUTCString()}document.cookie=e+"="+(n||"")+r+"; path=/"}var userId=getCookie("user_id");function sendTrackingData(){var e=new URLSearchParams;e.append("userId",userId),e.append("eventType","pageView"),e.append("referrer",document.referrer),e.append("pageUrl",window.location.href);var n=getCookie("_la"),t=getCookie("_lo");n&&t&&(e.append("la",n),e.append("lo",t));var r=getCookie("__gtm_campaign_url");if(r&&(e.has("utmSource")?e.set("utmSource",r):e.append("utmSource",r)),navigator.sendBeacon)navigator.sendBeacon("https://us-central1-envious-detailing-firestore.cloudfunctions.net/trackEvent",e);else{var a=new XMLHttpRequest;a.open("POST",beaconUrl,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(e)}}userId||(setCookie("user_id",userId=uuidv4(),365),document.getElementById("cookieCompliance").style.display="block"),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",sendTrackingData):sendTrackingData();
